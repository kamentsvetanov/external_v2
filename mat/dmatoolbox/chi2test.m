function p = chi2test(X2,df)% CHI2TEST  Calculate the probability under a chi-square distribution%    P = CHI2TEST(X2,DF), where X2 is an observed value and DF is the%    number of degrees of freedom, returns P, the probability of observing%    a value of the chi-square statistic that is at least as extreme as X2.%%   Author: Joachim Vandekerckhove (joachim.vandekerckhove@psy.kuleuven.be)%   Part of the DMA Toolbox. Please read the End User License Agreement,%   contained in 'dmateula.txt' or by invoking the DMATLICENSE command. %   See also http://ppw.kuleuven.be/okp/dmatoolbox.%  Edit 0.4: Added some input checking. Now returns NaN for negative%  inputs, and combines NaN and real values in case of vector input.if nargin<2    error('DMAT:chi2test:notEnoughInputs',...        'CHI2TEST requires exactly two input arguments.')endnx = numel(X2);nd = numel(df);if nx~=nd    if nx==1 && nd>1        X2 = repmat(X2,size(df));    elseif nd==1 && nx>1        df = repmat(df,size(X2));    else        error('DMAT:chi2test:unmatchedInputs',...            'Number of X2s and DFs must match.')    endendp = NaN(size(df));ind = X2>0&df>0;p(ind) = 1-gammainc(X2(ind)/2,df(ind)/2);